<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gesti√≥n de Equipo - Asobares</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
    .kanban-card { transition: transform 0.2s, box-shadow 0.2s, opacity 0.2s; }
    .kanban-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .kanban-card.dragging { opacity: 0.5; transform: rotate(3deg); }
    .kanban-column.drag-over { background: #dbeafe !important; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Logo Asobares
    const AsobaresLogo = ({ width = 280 }) => (
      <img src="/asobares_original.png" alt="Asobares" style={{ width: width, height: 'auto' }} />
    );

    const AsobaresLogoSmall = ({ width = 150 }) => (
      <img src="/asobares_blanco.png" alt="Asobares" style={{ width: width, height: 'auto' }} />
    );

    // Usuarios iniciales
    const initialUsers = [
      { id: 1, username: 'admin', name: 'Administrador', password: 'admin123', role: 'admin', cargo: 'Administrador', avatar: 'üëî' },
      { id: 2, username: 'eduardo.montoya', name: 'Eduardo Montoya', password: 'asobares123', role: 'user', cargo: 'Direcci√≥n Ejecutiva', avatar: 'üë®‚Äçüíº' },
      { id: 3, username: 'nereida.sanchez', name: 'Nereida Sanchez', password: 'asobares123', role: 'user', cargo: 'Direcci√≥n de Proyectos', avatar: 'üë©‚Äçüíº' },
      { id: 4, username: 'carlos.ulloa', name: 'Carlos Ulloa', password: 'asobares123', role: 'user', cargo: 'Direcci√≥n Cl√∫ster DJ', avatar: 'üéµ' },
      { id: 5, username: 'felipe.calderon', name: 'Felipe Calder√≥n', password: 'asobares123', role: 'user', cargo: 'Direcci√≥n C√≠rculo Gastro', avatar: 'üë®‚Äçüç≥' },
      { id: 6, username: 'lina.vasquez', name: 'Lina V√°squez', password: 'asobares123', role: 'user', cargo: 'Soporte Organizacional Afiliados', avatar: 'üë©‚Äçüíª' },
      { id: 7, username: 'sebastian.henao', name: 'Sebasti√°n Henao', password: 'asobares123', role: 'user', cargo: 'Dise√±o Web', avatar: 'üé®' },
      { id: 8, username: 'wilson.cardenas', name: 'Wilson Cardenas', password: 'asobares123', role: 'user', cargo: 'Community Manager & Graf', avatar: 'üì±' },
      { id: 9, username: 'andrea.chaparro', name: 'Andrea Chaparro', password: 'asobares123', role: 'user', cargo: 'Direcci√≥n Jur√≠dica', avatar: '‚öñÔ∏è' },
    ];

    const cargos = [
      'Direcci√≥n Ejecutiva', 'Direcci√≥n de Proyectos', 'Direcci√≥n Cl√∫ster DJ',
      'Direcci√≥n C√≠rculo Gastro', 'Soporte Organizacional Afiliados', 'Dise√±o Web',
      'Community Manager & Graf', 'Direcci√≥n Jur√≠dica',
    ];

    const ejesEstrategicos = [
      'Asobares', 'Proyectos', 'Cluster DJ', 'C√≠rculo Gastro', 'Mi destino tu noche',
      'Fontur', 'Alianza OSA', 'Asobares Medell√≠n', 'Formaci√≥n', 'Comunicaciones', 'Otro',
    ];

    const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 
                   'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];

    const statusLabels = {
      'planeado': { label: 'Planeado', color: '#3b82f6', bg: '#dbeafe' },
      'en-curso': { label: 'En Curso', color: '#f59e0b', bg: '#fef3c7' },
      'completado': { label: 'Completado', color: '#10b981', bg: '#d1fae5' },
      'retrasado': { label: 'Retrasado', color: '#ef4444', bg: '#fee2e2' },
    };

    const initialTasks = [
      { id: 1, mes: 'Enero', cargo: 'Dise√±o Web', responsable: 7, proyecto: 'Montar Landing C√≠rculo Gastro', ejeEstrategico: 'C√≠rculo Gastro', fechaInicio: '2026-01-15', fechaFin: '2026-01-26', estado: 'planeado', resultado: 'En proceso', descripcion: 'Crear Landing con la informaci√≥n del C√≠rculo gastro', objetivo: 'Dejarla terminada' },
      { id: 2, mes: 'Enero', cargo: 'Direcci√≥n de Proyectos', responsable: 3, proyecto: 'Liquidaciones Derecho de Autor', ejeEstrategico: 'Proyectos', fechaInicio: '2026-01-16', fechaFin: '2026-01-20', estado: 'completado', resultado: 'Completado', descripcion: 'Se entregaron los recibos', objetivo: 'Entregar las Liquidaciones' },
      { id: 3, mes: 'Enero', cargo: 'Direcci√≥n de Proyectos', responsable: 3, proyecto: 'Actualizaci√≥n Pagina Web Niglife', ejeEstrategico: 'Proyectos', fechaInicio: '2026-01-17', fechaFin: '2026-01-23', estado: 'retrasado', resultado: 'Pendiente', descripcion: 'Actualizar logos y direcci√≥n', objetivo: '' },
      { id: 4, mes: 'Enero', cargo: 'Dise√±o Web', responsable: 7, proyecto: 'Actualizar web Asobares', ejeEstrategico: 'Asobares', fechaInicio: '2026-01-19', fechaFin: '2026-01-22', estado: 'en-curso', resultado: 'En proceso', descripcion: 'Actualizar datos del equipo', objetivo: 'Dejar los datos completos' },
      { id: 5, mes: 'Enero', cargo: 'Direcci√≥n Cl√∫ster DJ', responsable: 4, proyecto: 'Actualizaci√≥n Base de Datos', ejeEstrategico: 'Cluster DJ', fechaInicio: '2026-01-05', fechaFin: '2026-01-10', estado: 'completado', resultado: 'Completado', descripcion: 'Actualizar la base de datos eliminando repetidos', objetivo: '' },
      { id: 6, mes: 'Enero', cargo: 'Soporte Organizacional Afiliados', responsable: 6, proyecto: 'Gesti√≥n de afiliados nuevos', ejeEstrategico: 'Asobares', fechaInicio: '2026-01-08', fechaFin: '2026-01-15', estado: 'en-curso', resultado: 'En proceso', descripcion: 'Procesar solicitudes de nuevos afiliados', objetivo: 'Completar 20 afiliaciones' },
      { id: 7, mes: 'Enero', cargo: 'Direcci√≥n Ejecutiva', responsable: 2, proyecto: 'Reuni√≥n Junta Directiva', ejeEstrategico: 'Asobares', fechaInicio: '2026-01-20', fechaFin: '2026-01-25', estado: 'planeado', resultado: '', descripcion: 'Preparar y liderar reuni√≥n mensual', objetivo: 'Aprobar presupuesto Q1' },
      { id: 8, mes: 'Enero', cargo: 'Community Manager & Graf', responsable: 8, proyecto: 'Campa√±a Redes Enero', ejeEstrategico: 'Comunicaciones', fechaInicio: '2026-01-01', fechaFin: '2026-01-31', estado: 'en-curso', resultado: 'En proceso', descripcion: 'Gesti√≥n de contenido mensual', objetivo: 'Aumentar engagement 15%' },
    ];

    function App() {
      // Cargar datos guardados del navegador o usar los iniciales
      const [currentUser, setCurrentUser] = useState(() => {
        const saved = localStorage.getItem('asobares_currentUser');
        return saved ? JSON.parse(saved) : null;
      });
      const [users, setUsers] = useState(() => {
        const saved = localStorage.getItem('asobares_users');
        return saved ? JSON.parse(saved) : initialUsers;
      });
      const [tasks, setTasks] = useState(() => {
        const saved = localStorage.getItem('asobares_tasks');
        return saved ? JSON.parse(saved) : initialTasks;
      });

      // Guardar autom√°ticamente cuando cambien los datos
      useEffect(() => {
        localStorage.setItem('asobares_users', JSON.stringify(users));
      }, [users]);

      useEffect(() => {
        localStorage.setItem('asobares_tasks', JSON.stringify(tasks));
      }, [tasks]);

      useEffect(() => {
        if (currentUser) {
          localStorage.setItem('asobares_currentUser', JSON.stringify(currentUser));
        } else {
          localStorage.removeItem('asobares_currentUser');
        }
      }, [currentUser]);

      const [view, setView] = useState('dashboard');
      const [showTaskModal, setShowTaskModal] = useState(false);
      const [showUserModal, setShowUserModal] = useState(false);
      const [editingTask, setEditingTask] = useState(null);
      const [filterMes, setFilterMes] = useState('all');
      const [filterEstado, setFilterEstado] = useState('all');
      const [filterUsuario, setFilterUsuario] = useState('all'); // Para admin ver tareas de otros
      const [searchTerm, setSearchTerm] = useState('');
      const [loginUsername, setLoginUsername] = useState('');
      const [loginPassword, setLoginPassword] = useState('');
      const [loginError, setLoginError] = useState('');
      const [notification, setNotification] = useState(null);
      const [draggedTask, setDraggedTask] = useState(null);

      const showNotification = (message, type = 'success') => {
        setNotification({ message, type });
        setTimeout(() => setNotification(null), 3000);
      };

      const handleLogin = () => {
        const user = users.find(u => u.username === loginUsername && u.password === loginPassword);
        if (user) {
          setCurrentUser(user);
          setLoginError('');
          showNotification(`¬°Bienvenido, ${user.name}!`);
        } else {
          setLoginError('Usuario o contrase√±a incorrectos');
        }
      };

      const handleLogout = () => {
        setCurrentUser(null);
        setView('dashboard');
        setLoginUsername('');
        setLoginPassword('');
      };

      const handleResetData = () => {
        if (confirm('¬øEst√°s seguro? Esto borrar√° TODAS las tareas y usuarios creados y volver√° a los datos iniciales.')) {
          localStorage.removeItem('asobares_users');
          localStorage.removeItem('asobares_tasks');
          localStorage.removeItem('asobares_currentUser');
          setUsers(initialUsers);
          setTasks(initialTasks);
          setCurrentUser(null);
          showNotification('Datos reiniciados correctamente');
        }
      };

      const handleSaveTask = (taskData) => {
        if (editingTask) {
          setTasks(tasks.map(t => t.id === editingTask.id ? { ...t, ...taskData } : t));
          showNotification('Tarea actualizada correctamente');
        } else {
          const newTask = { ...taskData, id: Math.max(...tasks.map(t => t.id), 0) + 1 };
          setTasks([...tasks, newTask]);
          showNotification('Tarea creada correctamente');
        }
        setShowTaskModal(false);
        setEditingTask(null);
      };

      const handleDeleteTask = (taskId) => {
        if (confirm('¬øEst√°s seguro de eliminar esta tarea?')) {
          setTasks(tasks.filter(t => t.id !== taskId));
          showNotification('Tarea eliminada');
        }
      };

      const handleCreateUser = (userData) => {
        const avatars = ['üë§', 'üë®', 'üë©', 'üßë', 'üë®‚Äçüíº', 'üë©‚Äçüíº', 'üë®‚Äçüíª', 'üë©‚Äçüíª'];
        const newUser = {
          ...userData,
          id: Math.max(...users.map(u => u.id)) + 1,
          avatar: avatars[Math.floor(Math.random() * avatars.length)],
          role: 'user',
        };
        setUsers([...users, newUser]);
        setShowUserModal(false);
        showNotification('Usuario creado correctamente');
      };

      // Funci√≥n para actualizar estado de tarea (drag & drop)
      const handleUpdateTaskStatus = (taskId, newStatus) => {
        setTasks(tasks.map(t => t.id === taskId ? { ...t, estado: newStatus } : t));
        showNotification(`Tarea movida a "${statusLabels[newStatus].label}"`);
      };

      // Drag and Drop handlers
      const handleDragStart = (e, task) => {
        setDraggedTask(task);
        e.target.classList.add('dragging');
      };

      const handleDragEnd = (e) => {
        setDraggedTask(null);
        e.target.classList.remove('dragging');
      };

      const handleDragOver = (e) => {
        e.preventDefault();
      };

      const handleDragEnter = (e) => {
        e.preventDefault();
        e.currentTarget.classList.add('drag-over');
      };

      const handleDragLeave = (e) => {
        e.currentTarget.classList.remove('drag-over');
      };

      const handleDrop = (e, newStatus) => {
        e.preventDefault();
        e.currentTarget.classList.remove('drag-over');
        if (draggedTask) {
          handleUpdateTaskStatus(draggedTask.id, newStatus);
        }
      };

      // Filtrar tareas seg√∫n usuario actual
      const getMyTasks = () => {
        if (currentUser.role === 'admin') {
          // Admin puede filtrar por usuario
          if (filterUsuario !== 'all') {
            return tasks.filter(t => t.responsable === parseInt(filterUsuario));
          }
          return tasks;
        } else {
          // Usuario normal solo ve sus tareas
          return tasks.filter(t => t.responsable === currentUser.id);
        }
      };

      const myTasks = currentUser ? getMyTasks() : [];

      const filteredTasks = myTasks.filter(task => {
        if (filterMes !== 'all' && task.mes !== filterMes) return false;
        if (filterEstado !== 'all' && task.estado !== filterEstado) return false;
        if (searchTerm && !task.proyecto.toLowerCase().includes(searchTerm.toLowerCase())) return false;
        return true;
      });

      // Estad√≠sticas basadas en fecha actual (mes actual)
      const currentMonth = meses[new Date().getMonth()];
      const currentYear = new Date().getFullYear();

      const getTasksForCurrentPeriod = (userTasks) => {
        return userTasks.filter(t => {
          const taskDate = new Date(t.fechaFin);
          const now = new Date();
          // Tareas del mes actual o que ya debieron completarse
          return taskDate.getMonth() === now.getMonth() && taskDate.getFullYear() === now.getFullYear() 
                 || (taskDate < now && t.estado !== 'completado');
        });
      };

      const getStatsForUser = (userId) => {
        const userTasks = tasks.filter(t => t.responsable === userId);
        const currentPeriodTasks = getTasksForCurrentPeriod(userTasks);
        const now = new Date();
        
        const completadas = currentPeriodTasks.filter(t => t.estado === 'completado').length;
        const enCurso = currentPeriodTasks.filter(t => t.estado === 'en-curso').length;
        const pendientes = currentPeriodTasks.filter(t => t.estado === 'planeado').length;
        const retrasadas = currentPeriodTasks.filter(t => {
          const fechaFin = new Date(t.fechaFin);
          return fechaFin < now && t.estado !== 'completado';
        }).length;
        const noCumplidas = currentPeriodTasks.filter(t => {
          const fechaFin = new Date(t.fechaFin);
          return fechaFin < now && t.estado !== 'completado';
        }).length;

        const total = currentPeriodTasks.length;
        const cumplimiento = total > 0 ? Math.round((completadas / total) * 100) : 0;

        return { total, completadas, enCurso, pendientes, retrasadas, noCumplidas, cumplimiento };
      };

      const myStats = currentUser ? getStatsForUser(currentUser.id) : {};

      const globalStats = {
        total: getTasksForCurrentPeriod(tasks).length,
        completadas: getTasksForCurrentPeriod(tasks).filter(t => t.estado === 'completado').length,
        enCurso: getTasksForCurrentPeriod(tasks).filter(t => t.estado === 'en-curso').length,
        pendientes: getTasksForCurrentPeriod(tasks).filter(t => t.estado === 'planeado').length,
        retrasadas: getTasksForCurrentPeriod(tasks).filter(t => {
          const fechaFin = new Date(t.fechaFin);
          return fechaFin < new Date() && t.estado !== 'completado';
        }).length,
      };
      globalStats.cumplimiento = globalStats.total > 0 ? Math.round((globalStats.completadas / globalStats.total) * 100) : 0;

      // Stats por usuario para admin
      const userStats = users.filter(u => u.role !== 'admin').map(user => ({
        ...user,
        ...getStatsForUser(user.id)
      }));

      // LOGIN SCREEN
      if (!currentUser) {
        return (
          <div style={{
            minHeight: '100vh',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f1a 100%)',
            padding: '20px',
          }}>
            <div style={{
              background: 'white',
              borderRadius: '24px',
              padding: '48px',
              width: '100%',
              maxWidth: '440px',
              boxShadow: '0 25px 60px rgba(232, 67, 56, 0.25)',
            }}>
              <div style={{ textAlign: 'center', marginBottom: '40px' }}>
                <div style={{ marginBottom: '20px', display: 'flex', justifyContent: 'center' }}>
                  <AsobaresLogo width={280} />
                </div>
                <div style={{ height: '1px', background: 'linear-gradient(90deg, transparent, #E84338, transparent)', margin: '24px 0' }}></div>
                <h2 style={{ fontSize: '20px', color: '#1a1a2e', fontWeight: '600', margin: 0 }}>
                  Gesti√≥n de Equipo
                </h2>
              </div>

              <div>
                <div style={{ marginBottom: '20px' }}>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: '600', color: '#374151' }}>
                    Usuario
                  </label>
                  <input
                    type="text"
                    value={loginUsername}
                    onChange={(e) => setLoginUsername(e.target.value)}
                    placeholder="nombre.apellido"
                    style={{
                      width: '100%',
                      padding: '14px 16px',
                      borderRadius: '12px',
                      border: '2px solid #e5e7eb',
                      fontSize: '16px',
                      boxSizing: 'border-box',
                      outline: 'none',
                    }}
                    onFocus={(e) => e.target.style.borderColor = '#E84338'}
                    onBlur={(e) => e.target.style.borderColor = '#e5e7eb'}
                  />
                </div>
                <div style={{ marginBottom: '24px' }}>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: '600', color: '#374151' }}>
                    Contrase√±a
                  </label>
                  <input
                    type="password"
                    value={loginPassword}
                    onChange={(e) => setLoginPassword(e.target.value)}
                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    style={{
                      width: '100%',
                      padding: '14px 16px',
                      borderRadius: '12px',
                      border: '2px solid #e5e7eb',
                      fontSize: '16px',
                      boxSizing: 'border-box',
                      outline: 'none',
                    }}
                    onFocus={(e) => e.target.style.borderColor = '#E84338'}
                    onBlur={(e) => e.target.style.borderColor = '#e5e7eb'}
                    onKeyDown={(e) => e.key === 'Enter' && handleLogin()}
                  />
                </div>
                {loginError && (
                  <p style={{ color: '#E84338', fontSize: '14px', margin: '0 0 16px', textAlign: 'center', fontWeight: '500' }}>
                    {loginError}
                  </p>
                )}
                <button
                  onClick={handleLogin}
                  style={{
                    width: '100%',
                    padding: '16px',
                    borderRadius: '12px',
                    border: 'none',
                    background: 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)',
                    color: 'white',
                    fontSize: '16px',
                    fontWeight: '700',
                    cursor: 'pointer',
                    boxShadow: '0 4px 15px rgba(232, 67, 56, 0.4)',
                  }}
                >
                  Iniciar Sesi√≥n
                </button>
              </div>

              <div style={{
                marginTop: '32px',
                padding: '20px',
                background: 'linear-gradient(135deg, #fef2f2 0%, #fff5f5 100%)',
                borderRadius: '12px',
                border: '1px solid #fecaca',
              }}>
                <p style={{ margin: '0 0 12px', fontSize: '13px', fontWeight: '700', color: '#b91c1c' }}>
                  üîë Credenciales de prueba:
                </p>
                <p style={{ margin: '4px 0', fontSize: '13px', color: '#991b1b', fontFamily: 'monospace' }}>
                  Admin: <strong>admin</strong> / <strong>admin123</strong>
                </p>
                <p style={{ margin: '4px 0', fontSize: '13px', color: '#991b1b', fontFamily: 'monospace' }}>
                  Usuario: <strong>sebastian.henao</strong> / <strong>asobares123</strong>
                </p>
              </div>
            </div>
          </div>
        );
      }

      // MAIN APP
      return (
        <div style={{ display: 'flex', minHeight: '100vh', background: '#f8f9fa' }}>
          {notification && (
            <div style={{
              position: 'fixed',
              top: '24px',
              right: '24px',
              padding: '16px 28px',
              borderRadius: '12px',
              background: notification.type === 'success' ? '#10b981' : '#E84338',
              color: 'white',
              fontSize: '14px',
              fontWeight: '600',
              boxShadow: '0 10px 40px rgba(0,0,0,0.2)',
              zIndex: 1000,
            }}>
              {notification.message}
            </div>
          )}

          {/* Sidebar */}
          <aside style={{
            width: '280px',
            background: 'linear-gradient(180deg, #1a1a2e 0%, #16213e 100%)',
            padding: '24px 16px',
            display: 'flex',
            flexDirection: 'column',
            position: 'fixed',
            height: '100vh',
            boxSizing: 'border-box',
          }}>
            <div style={{ padding: '0 8px 24px', borderBottom: '1px solid rgba(255,255,255,0.1)', marginBottom: '24px' }}>
              <AsobaresLogoSmall width={160} />
              <p style={{ color: '#94a3b8', fontSize: '11px', margin: '12px 0 0', letterSpacing: '1px', fontWeight: '500' }}>GESTI√ìN DE EQUIPO</p>
            </div>

            <nav style={{ display: 'flex', flexDirection: 'column', gap: '6px', flex: 1 }}>
              {[
                { id: 'dashboard', icon: 'üìä', label: 'Mi Dashboard' },
                { id: 'tasks', icon: 'üìã', label: 'Mis Tareas' },
                { id: 'board', icon: 'üìå', label: 'Mi Tablero Kanban' },
              ].map(item => (
                <button
                  key={item.id}
                  onClick={() => setView(item.id)}
                  style={{
                    display: 'flex',
                    alignItems: 'center',
                    gap: '12px',
                    padding: '14px 16px',
                    borderRadius: '10px',
                    border: 'none',
                    background: view === item.id ? 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)' : 'transparent',
                    color: view === item.id ? 'white' : '#94a3b8',
                    fontSize: '15px',
                    fontWeight: view === item.id ? '600' : '400',
                    cursor: 'pointer',
                    textAlign: 'left',
                  }}
                >
                  <span style={{ fontSize: '18px' }}>{item.icon}</span>
                  {item.label}
                </button>
              ))}
              {currentUser.role === 'admin' && (
                <>
                  <div style={{ height: '1px', background: 'rgba(255,255,255,0.1)', margin: '16px 0' }}></div>
                  <p style={{ color: '#64748b', fontSize: '11px', fontWeight: '600', padding: '0 16px', margin: '0 0 8px', letterSpacing: '1px' }}>ADMINISTRACI√ìN</p>
                  <button
                    onClick={() => setView('all-tasks')}
                    style={{
                      display: 'flex', alignItems: 'center', gap: '12px', padding: '14px 16px', borderRadius: '10px', border: 'none',
                      background: view === 'all-tasks' ? 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)' : 'transparent',
                      color: view === 'all-tasks' ? 'white' : '#94a3b8', fontSize: '15px', fontWeight: view === 'all-tasks' ? '600' : '400', cursor: 'pointer', textAlign: 'left',
                    }}
                  >
                    <span style={{ fontSize: '18px' }}>üìÅ</span> Todas las Tareas
                  </button>
                  <button
                    onClick={() => setView('team')}
                    style={{
                      display: 'flex', alignItems: 'center', gap: '12px', padding: '14px 16px', borderRadius: '10px', border: 'none',
                      background: view === 'team' ? 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)' : 'transparent',
                      color: view === 'team' ? 'white' : '#94a3b8', fontSize: '15px', fontWeight: view === 'team' ? '600' : '400', cursor: 'pointer', textAlign: 'left',
                    }}
                  >
                    <span style={{ fontSize: '18px' }}>üë•</span> Equipo
                  </button>
                  <button
                    onClick={() => setView('analytics')}
                    style={{
                      display: 'flex', alignItems: 'center', gap: '12px', padding: '14px 16px', borderRadius: '10px', border: 'none',
                      background: view === 'analytics' ? 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)' : 'transparent',
                      color: view === 'analytics' ? 'white' : '#94a3b8', fontSize: '15px', fontWeight: view === 'analytics' ? '600' : '400', cursor: 'pointer', textAlign: 'left',
                    }}
                  >
                    <span style={{ fontSize: '18px' }}>üìà</span> KPIs
                  </button>
                </>
              )}
            </nav>

            <div style={{ borderTop: '1px solid rgba(255,255,255,0.1)', paddingTop: '16px' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', padding: '12px', background: 'rgba(255,255,255,0.05)', borderRadius: '10px', marginBottom: '12px' }}>
                <span style={{ fontSize: '32px' }}>{currentUser.avatar}</span>
                <div style={{ flex: 1, minWidth: 0 }}>
                  <p style={{ color: 'white', fontSize: '14px', fontWeight: '600', margin: 0 }}>{currentUser.name}</p>
                  <p style={{ color: '#E84338', fontSize: '11px', margin: '2px 0 0', fontWeight: '500' }}>{currentUser.cargo}</p>
                </div>
              </div>
              <button
                onClick={handleLogout}
                style={{
                  width: '100%', padding: '12px', borderRadius: '10px', border: '1px solid rgba(255,255,255,0.1)',
                  background: 'transparent', color: '#94a3b8', fontSize: '14px', cursor: 'pointer', marginBottom: '8px',
                }}
              >
                Cerrar Sesi√≥n
              </button>
              {currentUser.role === 'admin' && (
                <button
                  onClick={handleResetData}
                  style={{
                    width: '100%', padding: '10px', borderRadius: '10px', border: '1px solid rgba(239,68,68,0.3)',
                    background: 'rgba(239,68,68,0.1)', color: '#f87171', fontSize: '12px', cursor: 'pointer',
                  }}
                >
                  üîÑ Reiniciar datos
                </button>
              )}
            </div>
          </aside>

          {/* Main Content */}
          <main style={{ flex: 1, marginLeft: '280px', padding: '32px' }}>
            {/* Header */}
            <header style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
              <div>
                <h1 style={{ fontSize: '28px', fontWeight: '700', color: '#1a1a2e', margin: 0 }}>
                  {view === 'dashboard' && `Mi Dashboard`}
                  {view === 'tasks' && 'Mis Tareas'}
                  {view === 'board' && 'Mi Tablero Kanban'}
                  {view === 'all-tasks' && 'Todas las Tareas'}
                  {view === 'team' && 'Gesti√≥n de Equipo'}
                  {view === 'analytics' && 'KPIs y Anal√≠ticas'}
                </h1>
                <p style={{ color: '#64748b', fontSize: '14px', margin: '4px 0 0' }}>
                  {currentMonth} {currentYear} ‚Ä¢ {currentUser.name}
                </p>
              </div>
              <button
                onClick={() => { setEditingTask(null); setShowTaskModal(true); }}
                style={{
                  padding: '14px 28px', borderRadius: '10px', border: 'none',
                  background: 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)',
                  color: 'white', fontSize: '14px', fontWeight: '700', cursor: 'pointer',
                  boxShadow: '0 4px 15px rgba(232, 67, 56, 0.3)', display: 'flex', alignItems: 'center', gap: '8px',
                }}
              >
                <span style={{ fontSize: '18px' }}>+</span> Nueva Tarea
              </button>
            </header>

            {/* Dashboard View */}
            {view === 'dashboard' && (
              <div>
                {/* Stats Cards - Personal */}
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: '20px', marginBottom: '32px' }}>
                  {[
                    { icon: 'üìã', value: myStats.total || 0, label: 'Mis Tareas', color: '#1a1a2e' },
                    { icon: '‚úÖ', value: myStats.completadas || 0, label: 'Completadas', color: '#10b981' },
                    { icon: 'üîÑ', value: myStats.enCurso || 0, label: 'En Curso', color: '#f59e0b' },
                    { icon: 'üìù', value: myStats.pendientes || 0, label: 'Pendientes', color: '#3b82f6' },
                    { icon: '‚ö†Ô∏è', value: myStats.retrasadas || 0, label: 'Retrasadas', color: '#E84338' },
                  ].map((stat, i) => (
                    <div key={i} style={{
                      background: 'white', borderRadius: '16px', padding: '24px',
                      boxShadow: '0 2px 8px rgba(0,0,0,0.04)', borderLeft: `4px solid ${stat.color}`,
                    }}>
                      <span style={{ fontSize: '28px' }}>{stat.icon}</span>
                      <p style={{ fontSize: '36px', fontWeight: '700', color: stat.color, margin: '8px 0 0' }}>{stat.value}</p>
                      <p style={{ fontSize: '13px', color: '#64748b', margin: '4px 0 0' }}>{stat.label}</p>
                    </div>
                  ))}
                </div>

                <div style={{ display: 'grid', gridTemplateColumns: '1fr 2fr', gap: '24px' }}>
                  {/* Mi Cumplimiento */}
                  <div style={{ background: 'white', borderRadius: '16px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>
                    <h2 style={{ fontSize: '16px', fontWeight: '600', color: '#1a1a2e', margin: '0 0 20px' }}>Mi Cumplimiento ({currentMonth})</h2>
                    <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                      <div style={{ position: 'relative', width: '140px', height: '140px' }}>
                        <svg width="140" height="140" viewBox="0 0 140 140">
                          <circle cx="70" cy="70" r="55" fill="none" stroke="#f1f5f9" strokeWidth="12" />
                          <circle cx="70" cy="70" r="55" fill="none" stroke={myStats.cumplimiento >= 70 ? '#10b981' : myStats.cumplimiento >= 40 ? '#f59e0b' : '#E84338'} strokeWidth="12"
                            strokeDasharray={`${((myStats.cumplimiento || 0) / 100) * 345} 345`}
                            strokeLinecap="round" transform="rotate(-90 70 70)" />
                        </svg>
                        <div style={{ position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ fontSize: '32px', fontWeight: '700', color: '#1a1a2e' }}>{myStats.cumplimiento || 0}%</span>
                        </div>
                      </div>
                      <div style={{ marginTop: '20px', textAlign: 'center' }}>
                        <p style={{ fontSize: '24px' }}>{myStats.cumplimiento >= 70 ? 'üü¢' : myStats.cumplimiento >= 40 ? 'üü°' : 'üî¥'}</p>
                        <p style={{ fontSize: '13px', color: '#64748b', marginTop: '8px' }}>
                          {myStats.completadas || 0} de {myStats.total || 0} tareas completadas
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* Mis Tareas Recientes */}
                  <div style={{ background: 'white', borderRadius: '16px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>
                    <h2 style={{ fontSize: '16px', fontWeight: '600', color: '#1a1a2e', margin: '0 0 20px' }}>Mis Tareas Pendientes</h2>
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                      {myTasks.filter(t => t.estado !== 'completado').slice(0, 5).map(task => (
                        <div key={task.id} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '14px', background: '#f8f9fa', borderRadius: '10px' }}>
                          <div>
                            <p style={{ fontSize: '14px', fontWeight: '600', color: '#1a1a2e', margin: 0 }}>{task.proyecto}</p>
                            <p style={{ fontSize: '12px', color: '#64748b', margin: '4px 0 0' }}>Vence: {task.fechaFin}</p>
                          </div>
                          <span style={{ padding: '6px 12px', borderRadius: '20px', fontSize: '11px', fontWeight: '600', background: statusLabels[task.estado].bg, color: statusLabels[task.estado].color }}>
                            {statusLabels[task.estado].label}
                          </span>
                        </div>
                      ))}
                      {myTasks.filter(t => t.estado !== 'completado').length === 0 && (
                        <p style={{ textAlign: 'center', color: '#64748b', padding: '20px' }}>üéâ ¬°No tienes tareas pendientes!</p>
                      )}
                    </div>
                  </div>
                </div>

                {/* Tareas Retrasadas */}
                {(myStats.retrasadas || 0) > 0 && (
                  <div style={{ background: '#fef2f2', borderRadius: '16px', padding: '24px', border: '1px solid #fecaca', marginTop: '24px' }}>
                    <h2 style={{ fontSize: '16px', fontWeight: '600', color: '#b91c1c', margin: '0 0 16px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                      ‚ö†Ô∏è Mis Tareas Retrasadas ({myStats.retrasadas})
                    </h2>
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                      {myTasks.filter(t => {
                        const fechaFin = new Date(t.fechaFin);
                        return fechaFin < new Date() && t.estado !== 'completado';
                      }).map(task => (
                        <div key={task.id} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px 16px', background: 'white', borderRadius: '10px' }}>
                          <div>
                            <p style={{ fontSize: '14px', fontWeight: '600', color: '#1a1a2e', margin: 0 }}>{task.proyecto}</p>
                            <p style={{ fontSize: '12px', color: '#dc2626', margin: '2px 0 0' }}>Venci√≥: {task.fechaFin}</p>
                          </div>
                          <button
                            onClick={() => { setEditingTask(task); setShowTaskModal(true); }}
                            style={{ padding: '8px 16px', borderRadius: '8px', border: 'none', background: '#E84338', color: 'white', fontSize: '12px', fontWeight: '600', cursor: 'pointer' }}
                          >
                            Actualizar
                          </button>
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* Tasks View - Mis Tareas */}
            {view === 'tasks' && (
              <div>
                <div style={{ display: 'flex', gap: '16px', marginBottom: '24px', flexWrap: 'wrap' }}>
                  <input
                    type="text" placeholder="üîç Buscar..." value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                    style={{ flex: 1, minWidth: '200px', padding: '12px 16px', borderRadius: '10px', border: '2px solid #e5e7eb', fontSize: '14px', outline: 'none' }}
                  />
                  <select value={filterMes} onChange={(e) => setFilterMes(e.target.value)} style={{ padding: '12px 16px', borderRadius: '10px', border: '2px solid #e5e7eb', fontSize: '14px', background: 'white', cursor: 'pointer' }}>
                    <option value="all">Todos los meses</option>
                    {meses.map(m => <option key={m} value={m}>{m}</option>)}
                  </select>
                  <select value={filterEstado} onChange={(e) => setFilterEstado(e.target.value)} style={{ padding: '12px 16px', borderRadius: '10px', border: '2px solid #e5e7eb', fontSize: '14px', background: 'white', cursor: 'pointer' }}>
                    <option value="all">Todos los estados</option>
                    {Object.entries(statusLabels).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                  </select>
                </div>

                <div style={{ background: 'white', borderRadius: '16px', overflow: 'hidden', boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>
                  <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                    <thead>
                      <tr style={{ background: '#f8f9fa' }}>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Proyecto</th>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Eje</th>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Fechas</th>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Estado</th>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Acciones</th>
                      </tr>
                    </thead>
                    <tbody>
                      {filteredTasks.map(task => (
                        <tr key={task.id} style={{ borderTop: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '16px' }}>
                            <p style={{ fontSize: '14px', fontWeight: '600', color: '#1a1a2e', margin: 0 }}>{task.proyecto}</p>
                            <p style={{ fontSize: '12px', color: '#64748b', margin: '4px 0 0' }}>{task.descripcion}</p>
                          </td>
                          <td style={{ padding: '16px' }}>
                            <span style={{ padding: '4px 10px', borderRadius: '6px', fontSize: '11px', fontWeight: '600', background: '#f1f5f9', color: '#475569' }}>
                              {task.ejeEstrategico}
                            </span>
                          </td>
                          <td style={{ padding: '16px' }}>
                            <p style={{ fontSize: '12px', margin: 0 }}>üìÖ {task.fechaInicio}</p>
                            <p style={{ fontSize: '12px', color: '#64748b', margin: '2px 0 0' }}>üèÅ {task.fechaFin}</p>
                          </td>
                          <td style={{ padding: '16px' }}>
                            <span style={{ padding: '6px 12px', borderRadius: '20px', fontSize: '11px', fontWeight: '600', background: statusLabels[task.estado].bg, color: statusLabels[task.estado].color }}>
                              {statusLabels[task.estado].label}
                            </span>
                          </td>
                          <td style={{ padding: '16px' }}>
                            <button onClick={() => { setEditingTask(task); setShowTaskModal(true); }} style={{ padding: '8px 12px', borderRadius: '8px', border: 'none', background: '#f1f5f9', cursor: 'pointer', marginRight: '8px' }}>‚úèÔ∏è</button>
                            <button onClick={() => handleDeleteTask(task.id)} style={{ padding: '8px 12px', borderRadius: '8px', border: 'none', background: '#fee2e2', cursor: 'pointer' }}>üóëÔ∏è</button>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                  {filteredTasks.length === 0 && (
                    <p style={{ textAlign: 'center', padding: '48px', color: '#64748b' }}>No tienes tareas asignadas</p>
                  )}
                </div>
              </div>
            )}

            {/* Kanban Board - Mi Tablero (Drag & Drop) */}
            {view === 'board' && (
              <div>
                <p style={{ color: '#64748b', fontSize: '14px', marginBottom: '20px' }}>üí° Arrastra y suelta las tarjetas para cambiar el estado de tus tareas</p>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '20px' }}>
                  {Object.entries(statusLabels).map(([statusKey, statusVal]) => (
                    <div 
                      key={statusKey} 
                      className="kanban-column"
                      onDragOver={handleDragOver}
                      onDragEnter={handleDragEnter}
                      onDragLeave={handleDragLeave}
                      onDrop={(e) => handleDrop(e, statusKey)}
                      style={{ background: '#f1f5f9', borderRadius: '16px', padding: '16px', minHeight: '500px', transition: 'background 0.2s' }}
                    >
                      <div style={{ background: 'white', borderRadius: '12px', padding: '14px', marginBottom: '16px', borderTop: `4px solid ${statusVal.color}` }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                          <h3 style={{ fontSize: '14px', fontWeight: '700', color: '#1a1a2e', margin: 0 }}>{statusVal.label}</h3>
                          <span style={{ background: statusVal.bg, color: statusVal.color, padding: '4px 12px', borderRadius: '20px', fontSize: '12px', fontWeight: '700' }}>
                            {myTasks.filter(t => t.estado === statusKey).length}
                          </span>
                        </div>
                      </div>
                      <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                        {myTasks.filter(t => t.estado === statusKey).map(task => (
                          <div 
                            key={task.id} 
                            className="kanban-card"
                            draggable
                            onDragStart={(e) => handleDragStart(e, task)}
                            onDragEnd={handleDragEnd}
                            onClick={() => { setEditingTask(task); setShowTaskModal(true); }}
                            style={{ background: 'white', borderRadius: '12px', padding: '16px', cursor: 'grab', boxShadow: '0 2px 4px rgba(0,0,0,0.04)' }}
                          >
                            <span style={{ padding: '4px 8px', borderRadius: '6px', fontSize: '10px', fontWeight: '600', background: '#f1f5f9', color: '#475569' }}>
                              {task.ejeEstrategico}
                            </span>
                            <h4 style={{ fontSize: '14px', fontWeight: '600', color: '#1a1a2e', margin: '12px 0 8px' }}>{task.proyecto}</h4>
                            <p style={{ fontSize: '12px', color: '#64748b', margin: '0 0 12px', lineHeight: '1.4' }}>{task.descripcion}</p>
                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', paddingTop: '12px', borderTop: '1px solid #f1f5f9' }}>
                              <span style={{ fontSize: '10px', color: '#94a3b8' }}>üèÅ {task.fechaFin}</span>
                              <span style={{ fontSize: '16px' }}>‚ãÆ‚ãÆ</span>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* All Tasks View - Admin */}
            {view === 'all-tasks' && currentUser.role === 'admin' && (
              <div>
                <div style={{ display: 'flex', gap: '16px', marginBottom: '24px', flexWrap: 'wrap' }}>
                  <input
                    type="text" placeholder="üîç Buscar..." value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                    style={{ flex: 1, minWidth: '200px', padding: '12px 16px', borderRadius: '10px', border: '2px solid #e5e7eb', fontSize: '14px', outline: 'none' }}
                  />
                  <select value={filterUsuario} onChange={(e) => setFilterUsuario(e.target.value)} style={{ padding: '12px 16px', borderRadius: '10px', border: '2px solid #e5e7eb', fontSize: '14px', background: 'white', cursor: 'pointer' }}>
                    <option value="all">Todos los usuarios</option>
                    {users.filter(u => u.role !== 'admin').map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                  </select>
                  <select value={filterEstado} onChange={(e) => setFilterEstado(e.target.value)} style={{ padding: '12px 16px', borderRadius: '10px', border: '2px solid #e5e7eb', fontSize: '14px', background: 'white', cursor: 'pointer' }}>
                    <option value="all">Todos los estados</option>
                    {Object.entries(statusLabels).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                  </select>
                </div>

                <div style={{ background: 'white', borderRadius: '16px', overflow: 'hidden', boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>
                  <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                    <thead>
                      <tr style={{ background: '#f8f9fa' }}>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Proyecto</th>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Responsable</th>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Fechas</th>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Estado</th>
                        <th style={{ padding: '16px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b', textTransform: 'uppercase' }}>Acciones</th>
                      </tr>
                    </thead>
                    <tbody>
                      {filteredTasks.map(task => {
                        const responsable = users.find(u => u.id === task.responsable);
                        return (
                          <tr key={task.id} style={{ borderTop: '1px solid #f1f5f9' }}>
                            <td style={{ padding: '16px' }}>
                              <p style={{ fontSize: '14px', fontWeight: '600', color: '#1a1a2e', margin: 0 }}>{task.proyecto}</p>
                              <p style={{ fontSize: '12px', color: '#64748b', margin: '4px 0 0' }}>{task.ejeEstrategico}</p>
                            </td>
                            <td style={{ padding: '16px' }}>
                              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                                <span style={{ fontSize: '20px' }}>{responsable?.avatar}</span>
                                <div>
                                  <p style={{ fontSize: '13px', fontWeight: '500', margin: 0 }}>{responsable?.name}</p>
                                  <p style={{ fontSize: '11px', color: '#64748b', margin: 0 }}>{responsable?.cargo}</p>
                                </div>
                              </div>
                            </td>
                            <td style={{ padding: '16px' }}>
                              <p style={{ fontSize: '12px', margin: 0 }}>üìÖ {task.fechaInicio}</p>
                              <p style={{ fontSize: '12px', color: '#64748b', margin: '2px 0 0' }}>üèÅ {task.fechaFin}</p>
                            </td>
                            <td style={{ padding: '16px' }}>
                              <span style={{ padding: '6px 12px', borderRadius: '20px', fontSize: '11px', fontWeight: '600', background: statusLabels[task.estado].bg, color: statusLabels[task.estado].color }}>
                                {statusLabels[task.estado].label}
                              </span>
                            </td>
                            <td style={{ padding: '16px' }}>
                              <button onClick={() => { setEditingTask(task); setShowTaskModal(true); }} style={{ padding: '8px 12px', borderRadius: '8px', border: 'none', background: '#f1f5f9', cursor: 'pointer', marginRight: '8px' }}>‚úèÔ∏è</button>
                              <button onClick={() => handleDeleteTask(task.id)} style={{ padding: '8px 12px', borderRadius: '8px', border: 'none', background: '#fee2e2', cursor: 'pointer' }}>üóëÔ∏è</button>
                            </td>
                          </tr>
                        );
                      })}
                    </tbody>
                  </table>
                </div>
              </div>
            )}

            {/* Team View */}
            {view === 'team' && currentUser.role === 'admin' && (
              <div>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>
                  <h2 style={{ fontSize: '18px', fontWeight: '600', margin: 0 }}>Miembros del Equipo</h2>
                  <button onClick={() => setShowUserModal(true)} style={{ padding: '12px 24px', borderRadius: '10px', border: 'none', background: 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)', color: 'white', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>
                    + A√±adir Usuario
                  </button>
                </div>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(320px, 1fr))', gap: '20px' }}>
                  {users.filter(u => u.role !== 'admin').map(user => {
                    const stats = getStatsForUser(user.id);
                    return (
                      <div key={user.id} style={{ background: 'white', borderRadius: '16px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '16px' }}>
                          <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                            <span style={{ fontSize: '40px' }}>{user.avatar}</span>
                            <div>
                              <h3 style={{ fontSize: '16px', fontWeight: '700', margin: 0 }}>{user.name}</h3>
                              <p style={{ fontSize: '12px', color: '#E84338', margin: '2px 0 0', fontWeight: '500' }}>{user.cargo}</p>
                            </div>
                          </div>
                          <span style={{ fontSize: '28px' }}>{stats.cumplimiento >= 70 ? 'üü¢' : stats.cumplimiento >= 40 ? 'üü°' : 'üî¥'}</span>
                        </div>
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '12px', padding: '16px 0', borderTop: '1px solid #f1f5f9', borderBottom: '1px solid #f1f5f9' }}>
                          <div style={{ textAlign: 'center' }}>
                            <p style={{ fontSize: '20px', fontWeight: '700', color: '#1a1a2e', margin: 0 }}>{stats.total}</p>
                            <p style={{ fontSize: '10px', color: '#64748b', margin: '4px 0 0' }}>Total</p>
                          </div>
                          <div style={{ textAlign: 'center' }}>
                            <p style={{ fontSize: '20px', fontWeight: '700', color: '#10b981', margin: 0 }}>{stats.completadas}</p>
                            <p style={{ fontSize: '10px', color: '#64748b', margin: '4px 0 0' }}>Completadas</p>
                          </div>
                          <div style={{ textAlign: 'center' }}>
                            <p style={{ fontSize: '20px', fontWeight: '700', color: '#3b82f6', margin: 0 }}>{stats.pendientes}</p>
                            <p style={{ fontSize: '10px', color: '#64748b', margin: '4px 0 0' }}>Pendientes</p>
                          </div>
                          <div style={{ textAlign: 'center' }}>
                            <p style={{ fontSize: '20px', fontWeight: '700', color: '#E84338', margin: 0 }}>{stats.retrasadas}</p>
                            <p style={{ fontSize: '10px', color: '#64748b', margin: '4px 0 0' }}>Retrasadas</p>
                          </div>
                        </div>
                        <div style={{ marginTop: '16px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                            <span style={{ fontSize: '12px', color: '#64748b' }}>Cumplimiento</span>
                            <span style={{ fontSize: '12px', fontWeight: '700', color: stats.cumplimiento >= 70 ? '#10b981' : stats.cumplimiento >= 40 ? '#f59e0b' : '#E84338' }}>{stats.cumplimiento}%</span>
                          </div>
                          <div style={{ height: '8px', background: '#f1f5f9', borderRadius: '4px', overflow: 'hidden' }}>
                            <div style={{ height: '100%', width: `${stats.cumplimiento}%`, background: stats.cumplimiento >= 70 ? '#10b981' : stats.cumplimiento >= 40 ? '#f59e0b' : '#E84338', borderRadius: '4px' }}></div>
                          </div>
                        </div>
                        <button
                          onClick={() => { setFilterUsuario(user.id.toString()); setView('all-tasks'); }}
                          style={{ width: '100%', marginTop: '16px', padding: '10px', borderRadius: '8px', border: '1px solid #e5e7eb', background: 'white', color: '#64748b', fontSize: '13px', cursor: 'pointer' }}
                        >
                          Ver tareas ‚Üí
                        </button>
                      </div>
                    );
                  })}
                </div>
              </div>
            )}

            {/* Analytics View */}
            {view === 'analytics' && currentUser.role === 'admin' && (
              <div>
                {/* Resumen Global */}
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: '20px', marginBottom: '32px' }}>
                  {[
                    { icon: 'üìã', value: globalStats.total, label: 'Total Per√≠odo', color: '#1a1a2e' },
                    { icon: '‚úÖ', value: globalStats.completadas, label: 'Completadas', color: '#10b981' },
                    { icon: 'üîÑ', value: globalStats.enCurso, label: 'En Curso', color: '#f59e0b' },
                    { icon: 'üìù', value: globalStats.pendientes, label: 'Pendientes', color: '#3b82f6' },
                    { icon: '‚ö†Ô∏è', value: globalStats.retrasadas, label: 'No Cumplidas', color: '#E84338' },
                  ].map((stat, i) => (
                    <div key={i} style={{ background: 'white', borderRadius: '16px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.04)', borderLeft: `4px solid ${stat.color}` }}>
                      <span style={{ fontSize: '24px' }}>{stat.icon}</span>
                      <p style={{ fontSize: '32px', fontWeight: '700', color: stat.color, margin: '8px 0 0' }}>{stat.value}</p>
                      <p style={{ fontSize: '12px', color: '#64748b', margin: '4px 0 0' }}>{stat.label}</p>
                    </div>
                  ))}
                </div>

                <div style={{ background: 'white', borderRadius: '16px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>
                  <h2 style={{ fontSize: '18px', fontWeight: '600', margin: '0 0 24px' }}>Ranking de Desempe√±o - {currentMonth} {currentYear}</h2>
                  <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                    <thead>
                      <tr style={{ background: '#f8f9fa' }}>
                        <th style={{ padding: '14px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b' }}>#</th>
                        <th style={{ padding: '14px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b' }}>RESPONSABLE</th>
                        <th style={{ padding: '14px', textAlign: 'center', fontSize: '12px', fontWeight: '700', color: '#64748b' }}>TOTAL</th>
                        <th style={{ padding: '14px', textAlign: 'center', fontSize: '12px', fontWeight: '700', color: '#64748b' }}>COMPLETADAS</th>
                        <th style={{ padding: '14px', textAlign: 'center', fontSize: '12px', fontWeight: '700', color: '#64748b' }}>PENDIENTES</th>
                        <th style={{ padding: '14px', textAlign: 'center', fontSize: '12px', fontWeight: '700', color: '#64748b' }}>NO CUMPLIDAS</th>
                        <th style={{ padding: '14px', textAlign: 'left', fontSize: '12px', fontWeight: '700', color: '#64748b' }}>CUMPLIMIENTO</th>
                        <th style={{ padding: '14px', textAlign: 'center', fontSize: '12px', fontWeight: '700', color: '#64748b' }}>ESTADO</th>
                      </tr>
                    </thead>
                    <tbody>
                      {userStats.sort((a, b) => b.cumplimiento - a.cumplimiento).map((member, idx) => (
                        <tr key={member.id} style={{ borderTop: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '16px', fontSize: '18px' }}>{idx === 0 ? 'ü•á' : idx === 1 ? 'ü•à' : idx === 2 ? 'ü•â' : `${idx + 1}`}</td>
                          <td style={{ padding: '16px' }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                              <span style={{ fontSize: '24px' }}>{member.avatar}</span>
                              <div>
                                <p style={{ fontWeight: '600', margin: 0 }}>{member.name}</p>
                                <p style={{ fontSize: '12px', color: '#E84338', margin: 0 }}>{member.cargo}</p>
                              </div>
                            </div>
                          </td>
                          <td style={{ padding: '16px', textAlign: 'center', fontWeight: '600' }}>{member.total}</td>
                          <td style={{ padding: '16px', textAlign: 'center', fontWeight: '600', color: '#10b981' }}>{member.completadas}</td>
                          <td style={{ padding: '16px', textAlign: 'center', fontWeight: '600', color: '#3b82f6' }}>{member.pendientes}</td>
                          <td style={{ padding: '16px', textAlign: 'center', fontWeight: '600', color: '#E84338' }}>{member.retrasadas}</td>
                          <td style={{ padding: '16px' }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                              <div style={{ flex: 1, height: '10px', background: '#f1f5f9', borderRadius: '5px', overflow: 'hidden' }}>
                                <div style={{ height: '100%', width: `${member.cumplimiento}%`, background: member.cumplimiento >= 70 ? '#10b981' : member.cumplimiento >= 40 ? '#f59e0b' : '#E84338', borderRadius: '5px' }}></div>
                              </div>
                              <span style={{ fontWeight: '700', color: member.cumplimiento >= 70 ? '#10b981' : member.cumplimiento >= 40 ? '#f59e0b' : '#E84338', minWidth: '45px' }}>{member.cumplimiento}%</span>
                            </div>
                          </td>
                          <td style={{ padding: '16px', textAlign: 'center', fontSize: '24px' }}>
                            {member.cumplimiento >= 70 ? 'üü¢' : member.cumplimiento >= 40 ? 'üü°' : 'üî¥'}
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
            )}
          </main>

          {/* Task Modal */}
          {showTaskModal && (
            <TaskModal 
              task={editingTask} 
              users={users} 
              currentUser={currentUser}
              onSave={handleSaveTask} 
              onClose={() => { setShowTaskModal(false); setEditingTask(null); }} 
            />
          )}

          {/* User Modal */}
          {showUserModal && currentUser.role === 'admin' && (
            <UserModal cargos={cargos} onSave={handleCreateUser} onClose={() => setShowUserModal(false)} />
          )}
        </div>
      );
    }

    function TaskModal({ task, users, currentUser, onSave, onClose }) {
      const [mes, setMes] = useState(task?.mes || meses[new Date().getMonth()]);
      const [cargo, setCargo] = useState(task?.cargo || currentUser.cargo);
      const [responsable, setResponsable] = useState(task?.responsable || (currentUser.role === 'admin' ? users.find(u => u.role !== 'admin')?.id : currentUser.id));
      const [proyecto, setProyecto] = useState(task?.proyecto || '');
      const [ejeEstrategico, setEjeEstrategico] = useState(task?.ejeEstrategico || ejesEstrategicos[0]);
      const [fechaInicio, setFechaInicio] = useState(task?.fechaInicio || new Date().toISOString().split('T')[0]);
      const [fechaFin, setFechaFin] = useState(task?.fechaFin || '');
      const [estado, setEstado] = useState(task?.estado || 'planeado');
      const [descripcion, setDescripcion] = useState(task?.descripcion || '');
      const [objetivo, setObjetivo] = useState(task?.objetivo || '');
      const [resultado, setResultado] = useState(task?.resultado || '');

      const handleSubmit = () => {
        if (!proyecto.trim()) return;
        onSave({ mes, cargo, responsable: parseInt(responsable), proyecto, ejeEstrategico, fechaInicio, fechaFin, estado, descripcion, objetivo, resultado });
      };

      const inputStyle = { width: '100%', padding: '12px 14px', borderRadius: '10px', border: '2px solid #e5e7eb', fontSize: '14px', boxSizing: 'border-box', outline: 'none' };

      return (
        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.6)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100, padding: '20px' }}>
          <div style={{ background: 'white', borderRadius: '20px', width: '100%', maxWidth: '600px', maxHeight: '90vh', overflow: 'auto' }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '24px', background: 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)', borderRadius: '20px 20px 0 0' }}>
              <h2 style={{ fontSize: '20px', fontWeight: '700', color: 'white', margin: 0 }}>{task ? '‚úèÔ∏è Editar Tarea' : '‚ûï Nueva Tarea'}</h2>
              <button onClick={onClose} style={{ width: '40px', height: '40px', borderRadius: '10px', border: 'none', background: 'rgba(255,255,255,0.2)', fontSize: '20px', color: 'white', cursor: 'pointer' }}>√ó</button>
            </div>
            <div style={{ padding: '24px', display: 'flex', flexDirection: 'column', gap: '20px' }}>
              <div>
                <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Proyecto / Acci√≥n *</label>
                <input type="text" value={proyecto} onChange={(e) => setProyecto(e.target.value)} placeholder="Nombre del proyecto" style={inputStyle} />
              </div>
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                <div>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Mes</label>
                  <select value={mes} onChange={(e) => setMes(e.target.value)} style={inputStyle}>{meses.map(m => <option key={m} value={m}>{m}</option>)}</select>
                </div>
                <div>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Eje Estrat√©gico</label>
                  <select value={ejeEstrategico} onChange={(e) => setEjeEstrategico(e.target.value)} style={inputStyle}>{ejesEstrategicos.map(e => <option key={e} value={e}>{e}</option>)}</select>
                </div>
              </div>
              {currentUser.role === 'admin' && (
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                  <div>
                    <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Cargo</label>
                    <select value={cargo} onChange={(e) => setCargo(e.target.value)} style={inputStyle}>{cargos.map(c => <option key={c} value={c}>{c}</option>)}</select>
                  </div>
                  <div>
                    <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Responsable</label>
                    <select value={responsable} onChange={(e) => setResponsable(e.target.value)} style={inputStyle}>
                      {users.filter(u => u.role !== 'admin').map(u => <option key={u.id} value={u.id}>{u.avatar} {u.name}</option>)}
                    </select>
                  </div>
                </div>
              )}
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '16px' }}>
                <div>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>üìÖ Fecha Inicio</label>
                  <input type="date" value={fechaInicio} onChange={(e) => setFechaInicio(e.target.value)} style={inputStyle} />
                </div>
                <div>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>üèÅ Fecha Fin</label>
                  <input type="date" value={fechaFin} onChange={(e) => setFechaFin(e.target.value)} style={inputStyle} />
                </div>
                <div>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Estado</label>
                  <select value={estado} onChange={(e) => setEstado(e.target.value)} style={inputStyle}>
                    {Object.entries(statusLabels).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                  </select>
                </div>
              </div>
              <div>
                <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Descripci√≥n</label>
                <textarea value={descripcion} onChange={(e) => setDescripcion(e.target.value)} placeholder="Describe la tarea..." rows={2} style={{ ...inputStyle, resize: 'vertical', fontFamily: 'inherit' }} />
              </div>
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                <div>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Objetivo</label>
                  <input type="text" value={objetivo} onChange={(e) => setObjetivo(e.target.value)} placeholder="Objetivo del mes" style={inputStyle} />
                </div>
                <div>
                  <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Resultado / Avance</label>
                  <input type="text" value={resultado} onChange={(e) => setResultado(e.target.value)} placeholder="Estado actual" style={inputStyle} />
                </div>
              </div>
              <div style={{ display: 'flex', gap: '12px', justifyContent: 'flex-end', marginTop: '8px' }}>
                <button onClick={onClose} style={{ padding: '12px 24px', borderRadius: '10px', border: '2px solid #e5e7eb', background: 'white', color: '#64748b', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Cancelar</button>
                <button onClick={handleSubmit} style={{ padding: '12px 32px', borderRadius: '10px', border: 'none', background: 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)', color: 'white', fontSize: '14px', fontWeight: '700', cursor: 'pointer' }}>{task ? 'Guardar' : 'Crear Tarea'}</button>
              </div>
            </div>
          </div>
        </div>
      );
    }

    function UserModal({ cargos, onSave, onClose }) {
      const [name, setName] = useState('');
      const [username, setUsername] = useState('');
      const [password, setPassword] = useState('');
      const [cargo, setCargo] = useState(cargos[0]);

      const handleSubmit = () => {
        if (!name.trim() || !username.trim() || !password.trim()) return;
        onSave({ name, username, password, cargo });
      };

      const inputStyle = { width: '100%', padding: '12px 14px', borderRadius: '10px', border: '2px solid #e5e7eb', fontSize: '14px', boxSizing: 'border-box', outline: 'none' };

      return (
        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.6)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100 }}>
          <div style={{ background: 'white', borderRadius: '20px', width: '100%', maxWidth: '450px' }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '24px', background: 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)', borderRadius: '20px 20px 0 0' }}>
              <h2 style={{ fontSize: '20px', fontWeight: '700', color: 'white', margin: 0 }}>üë§ Nuevo Usuario</h2>
              <button onClick={onClose} style={{ width: '40px', height: '40px', borderRadius: '10px', border: 'none', background: 'rgba(255,255,255,0.2)', fontSize: '20px', color: 'white', cursor: 'pointer' }}>√ó</button>
            </div>
            <div style={{ padding: '24px', display: 'flex', flexDirection: 'column', gap: '20px' }}>
              <div>
                <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Nombre completo *</label>
                <input type="text" value={name} onChange={(e) => setName(e.target.value)} placeholder="Nombre" style={inputStyle} />
              </div>
              <div>
                <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Usuario *</label>
                <input type="text" value={username} onChange={(e) => setUsername(e.target.value)} placeholder="nombre.apellido" style={inputStyle} />
              </div>
              <div>
                <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Contrase√±a *</label>
                <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} placeholder="Contrase√±a" style={inputStyle} />
              </div>
              <div>
                <label style={{ display: 'block', marginBottom: '8px', fontSize: '13px', fontWeight: '600', color: '#374151' }}>Cargo</label>
                <select value={cargo} onChange={(e) => setCargo(e.target.value)} style={inputStyle}>{cargos.map(c => <option key={c} value={c}>{c}</option>)}</select>
              </div>
              <div style={{ display: 'flex', gap: '12px', justifyContent: 'flex-end' }}>
                <button onClick={onClose} style={{ padding: '12px 24px', borderRadius: '10px', border: '2px solid #e5e7eb', background: 'white', color: '#64748b', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Cancelar</button>
                <button onClick={handleSubmit} style={{ padding: '12px 32px', borderRadius: '10px', border: 'none', background: 'linear-gradient(135deg, #E84338 0%, #c41e16 100%)', color: 'white', fontSize: '14px', fontWeight: '700', cursor: 'pointer' }}>Crear</button>
              </div>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
